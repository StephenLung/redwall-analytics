---
title: Evaluating Mass Muni CAFR Textract Results - Part 5
author: David Lucey
date: '2020-04-24'
slug: evaluating-mass-muni-cafr-textract-results-part-5
categories: ["R", "Code-Oriented"]
tags: ["pdf", "pdftools", "tabulizer", "textract"]
output:
  html_document:
    code_folding: 'hide'
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<link href="/rmarkdown-libs/jsoneditor/jsoneditor.min.css" rel="stylesheet" />
<script src="/rmarkdown-libs/jsoneditor/jsoneditor.min.js"></script>
<script src="/rmarkdown-libs/jsonedit-binding/jsonedit.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/datatables-binding/datatables.js"></script>
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="/rmarkdown-libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>


<pre class="r"><code># Libraries
packages &lt;- 
  c(&quot;data.table&quot;,
    &quot;reticulate&quot;,
    &quot;paws.machine.learning&quot;,
    &quot;paws.common&quot;,
    &quot;keyring&quot;,
    &quot;pdftools&quot;,
    &quot;listviewer&quot;,
    &quot;readxl&quot;
    )

if (length(setdiff(packages,rownames(installed.packages()))) &gt; 0) {
  install.packages(setdiff(packages, rownames(installed.packages())))  
}

invisible(lapply(packages, library, character.only = TRUE))

knitr::opts_chunk$set(comment=NA, fig.width=12, fig.height=8, out.width = &#39;100%&#39;)</code></pre>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In <a href="https://redwallanalytics.com/2020/04/14/evaluating-mass-muni-cafr-tabulizer-results-part-3/">Evaluating Mass Muni CAFR Tabulizer Results - Part 3</a>, we showed how to use <code>pdftools</code> and <code>tabulizer</code> to subset a group of PDFs, the AWS <code>paws</code> SDK package to store the PDF in <code>s3</code>, and Textract machine learning to extract a block response object using its “asynchronous” process. Subsequently, we discovered an alternate route to save the desired pages as PNG and send those page-by-page to AWS to get the same result. In the last post <a href="https://redwallanalytics.com/2020/04/14/scraping-failed-tabulizer-pdfs-with-aws-textract-part-4/">Scraping Failed Tabulizer PDFs with AWS Textract - Part 4</a> method has the added advantage of being free to free-tier AWS users.</p>
<p>In this post, we will show how to do this, and also how to parse the response blocks (shown in Figure <a href="#tab:list-view"><strong>??</strong></a>), which took us a few days to figure out. As mentioned previously, the response blocks are complicated, with one nested list pertaining to text and another to the coordinates on the page. We attempted to write R-code to extract the required data, but in the end, decided to modify the AWS code, and call it within RStudio using the <code>reticulate</code> package. This had the added benefit of bringing together several pieces we had been working on.</p>
</div>
<div id="convert-selected-page-to-png-with-pdftools" class="section level1">
<h1>Convert Selected Page to PNG with <code>pdftools</code></h1>
<p>Below we show the steps extract the Balance Sheet (page 27) from the Attleboro CAFR as a png with the <code>pdftools</code> <code>pdf_convert()</code> function. At first, we used the default setting for dpi of 75, but we found that the resolution this was too fuzzy, and led to frequent errors on particular letters with the OCR. These were not eliminated, but significantly reduced once we switched to dpi of 200, but it seems like it might be beneficial to go even higher, because for example, the “l” was commonly dropped when it occurred at the end of a word (ie: “Governmenta”).</p>
<pre class="r"><code># Point to particular muni pdf on disc
pdf &lt;- 
  paste0(&quot;/Users/davidlucey/Desktop/David/Projects/mass_munis/data/pdf_cafr/attleboro_2018.pdf&quot;)
  
# Create png name for muni
png &lt;- 
  paste0(&quot;/Users/davidlucey/Desktop/David/Projects/pdf_cafr_parse/attleboro.png&quot;)
    
  # Convert report to png
pdf_convert(
  pdf, 
  format = &quot;png&quot;, 
  pages = 27, 
  filenames = png, 
  dpi = 200)</code></pre>
<pre><code>Converting page 27 to /Users/davidlucey/Desktop/David/Projects/pdf_cafr_parse/attleboro.png... done!</code></pre>
<pre><code>[1] &quot;/Users/davidlucey/Desktop/David/Projects/pdf_cafr_parse/attleboro.png&quot;</code></pre>
</div>
<div id="extract-page-with-aws-textract-synchronous-operation" class="section level1">
<h1>Extract Page with AWS Textract Synchronous Operation</h1>
<p>We input our AWS credentials and set up a Textract response object in the same way as in the previous post. One difference between synchronous and asynchronous (demonstrated in the last post), is that <code>paws</code> sends the request and gets the response with just the <code>analyze_document()</code> function, instead of <code>start_document_analysis()</code> and the second <code>get_document_analysis</code>. We also did not need to loop, because each page fit within the maximum of 1000 blocks, and was immediately returned without a second function call. We also used the Bytes argument to reference the PNG from our local environment instead of pointing Textract to an <code>s3</code> bucket.</p>
<pre class="r"><code># Call Textract for particular muni pdf page
response &lt;-
  svc$analyze_document(
    Document = list(
      Bytes = png
      ),
    FeatureTypes = list(
      &quot;TABLES&quot;
      )
    )</code></pre>
</div>
<div id="description-and-list-view-of-textract-response-object" class="section level1">
<h1>Description and List View of Textract Response Object</h1>
<p>In the chunk below, we show the anatomy of the response object in a subset of blocks. The first 10 tabs in the listviewer below have the <code>PAGE</code> (element 0) and some <code>LINE</code> elements (1-10), which are the parents of <code>WORD</code> and <code>CELL</code>. The <code>TABLE</code> block is shown in element 21, with its 168 children. <code>WORD</code> and <code>CELL</code> blocks are shown in lines 11-20 and 22-30, respectively. <code>CELL</code> and <code>WORD</code> blocks hvae no children, but can be used to find the location or row-column coordinates of a <code>WORD</code>. We spent a lot of time trying to understand the relationships between the different kinds of objects in order to parse it out in R, but in the end, it seemed easier just to use AWS’s pre-built Python parser via <code>reticulate</code>.</p>
<pre class="r"><code># Sample of blocks
listviewer::jsonedit(
  response[[&quot;Blocks&quot;]][c(1:10, 161:170, 421:430)]
)</code></pre>
<div id="htmlwidget-1" style="width:100%;height:768px;" class="jsonedit html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"BlockType":"PAGE","Confidence":[],"Text":[],"RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":1,"Height":1,"Left":0,"Top":0},"Polygon":[{"X":0,"Y":0},{"X":1,"Y":0},{"X":1,"Y":1},{"X":0,"Y":1}]},"Id":"7bee4053-42e9-4d4a-8d54-bf325fa7bb3b","Relationships":[{"Type":"CHILD","Ids":["b089f2d8-44e3-4432-a1e6-0d4c457bf25c","65722cda-71e9-49a8-a809-493e27e6ecec","6a8eb039-837c-4ca3-a31f-59a49e8ab078","9ac624ae-fc16-4435-a5df-8c5b4eda0739","50f4b8b4-92c0-4b33-af5b-d94d247cb957","0f77a203-68cc-4112-8ed4-3971908ba640","36aabd47-5dc4-421c-aded-053b3809bec1","82fe59aa-fc01-437f-8c2e-292702a1647f","c936eb95-fde0-48c2-ae8b-9475af61f6f2","38f42100-4387-4f28-a097-5c609476629a","553da55c-4675-4938-baf0-16778d1fd976","43bc9724-c984-417d-9445-888ef9b7c1e2","3fa87b17-aaca-4200-aad3-7503bad7f4f1","2802deb0-f348-435b-a5d5-30b310f70548","a26e7aaf-1b3b-41ee-8dad-fa4c05c3d77d","ac4e3c0b-326b-4d8c-96ee-9d4fc0fa8819","550f00d6-81bb-48e8-bbfd-1e5f535d04b5","1f21fc87-a6c5-4106-b28c-9ad224be8702","4a91369f-c78a-4aa9-b4cd-97d41416bf95","93c11b40-e38d-4fbc-8172-fbfdb5b6706b","fecd8dd1-ea4a-4e2d-b5c6-8141322c2b7c","f2e46d27-0696-4e94-9410-3799ed4209a2","8e9cedab-c4de-488e-85c4-335dac4368cf","c592841c-a0c6-4f08-8789-4dca797c1d3a","a5e559cb-5218-49ad-846f-14a7ae711687","99c70fca-dddc-4971-83f8-a63cafd737e1","ff8700b1-8357-4d33-b8f8-2c46861396e0","acfd9991-81ce-4030-88e7-50bd673c0c6d","531c7d74-9863-4032-a4d6-69e1f78bcd13","599ea4b1-04c1-4846-96d6-589d2ebc25a9","ebfc958c-9ce4-4e02-b48c-800995dfdee2","850ecaa7-bd36-4f8c-a2d8-7a503bbbeb7a","b05d5c15-693b-4124-bd89-990a4f64b0a0","81de7e56-9f7d-404b-ac7a-223b6744cba4","6cc28c97-9ac8-4503-9c71-ba38e4c4f657","dc4e3955-79bd-4d37-afac-689d9f67c450","24719b70-5569-4bc1-a1e2-1016e9dae2f2","a1c81033-df8f-438c-a47d-349c892126f0","25a8d992-1d8a-4fc2-9157-d5b34cdbc4d7","c25808c5-84d8-49f6-a36d-ff70dc2a687e","c2189abb-39ad-4770-8083-4c6544bf02b3","10d92463-0e5b-4d0a-b20c-70c00b2d7308","3144425a-db2b-4c56-a4e8-e53e0acba073","a14b8964-c413-4bda-b576-422789c228c1","5bfe5b33-ff06-4e5d-ba34-5c87e1daa202","d1e617e5-0a1a-499c-914c-80e2a062e2d9","86fb94a3-49d0-4f80-9222-9765af4ee9eb","28325f8f-083d-4bfc-98ec-5d2b91147147","2b7f3f34-9d1f-4ef2-9c61-e1cc40a4759a","8302812c-3044-4f14-98cf-004e1a9cadd3","4506e2ad-59ae-404a-bcf4-b442d09012ee","45d06e07-8add-4329-9feb-df62c1504669","02b93ae7-2e3e-4d49-a26a-3744d1367a28","852bb5f1-af57-4dd2-b9d3-fe50e012c0d9","05b1ba39-364c-46e7-bc55-8313acbdddba","3de92595-72db-4f15-b9ed-5b549fe0cbb2","3b543bee-e87c-4912-bb28-387c08b84d43","9883def2-13ba-4fd5-8987-7e91f068e108","362718c4-7892-4909-86db-9de4d6c0cf18","d8d2151f-237b-439a-8328-24cafb68edd9","9f77b456-76a8-4d7c-9fd7-8397de7371ab","54b18f5d-a3e4-464a-95e0-9aa9fbc7570f","c0958e09-5499-4b49-9201-d324c9787ee4","2ac2f937-5a86-4d87-9e7d-1f4119725aea","421f1262-2156-4d3f-aca5-bc9d37688f11","4671ab44-938f-469d-af97-b24eb97a6f48","3d5fe9d4-8038-4f6d-9ce8-ecc3b449fb06","2ceb18a0-1fed-409e-ae9e-5b1036a958fc","a1bbcc22-dc71-48b6-b508-4aaf940829d9","622faafb-2126-4b2c-b432-3c0fb3356690","6a2978b6-b7bc-4282-85f5-d4124012b23b","896cfb85-2576-43b2-9702-8b5c7d6afbaf","950308a0-363a-46d7-9b74-15b51ed2bf89","94b227d0-a3ba-49bf-b9bd-7a32ce26a84c","9702dbe6-b039-4507-b715-302fd5bab0d7","746abbc9-e4ef-4d7b-b9cb-cd34685c3e52","96c7cb22-6e3a-4308-bb0c-582c3ef93382","263af8f5-83bc-47fc-91f7-8ea3cc0879c2","6ff1b634-382d-446f-a1f3-9efa1ee58da7","47393d27-051f-4bcc-b140-5b063edd19c0","8f2a1d6d-28a4-42b5-9bec-1758b04f90d4","6315f9f1-cc8a-4a03-9b85-181984fca354","b5d09393-3ecb-484c-8085-201f32ee2dc8","2f24a928-9aff-490c-8448-253d263b552a","ca6b1b71-0763-431c-9f69-8b64aebe139d","78c61883-a37d-418f-91f0-9008ea645cb0","0526b941-6f0a-4d92-8154-b5220b7cdd0c","b713586c-6dde-420a-9525-bf17d5103e31","3a5dd090-581b-4ea1-aa7d-5c8438898b77","4add966d-8ec1-4859-8779-f7af60b787e8","e4568e8e-3139-4569-b2b9-729acd014107","e9abad5b-f5b2-4475-a2cf-35ec908c0175","7032cd10-4082-44e1-9265-f3767cebffa7","f6534e24-d1a7-4557-811a-0748b1350dfb","bd19941e-61c1-4832-ae3d-a13d0c1374b4","81f3e382-26e6-4db4-b560-d505f7a63965","8703d248-f79b-454f-b09f-4521cc6e216f","1438eff9-5096-4a17-b128-430411b3763b","66dfe17b-3dfa-4280-a299-5ba7a0d8b6d0","e8f54d1f-5e4b-4bda-85b5-278cd4b924e4","8494d5bc-e28f-4dca-804a-4a582465b9d9","7bf0dbfb-ae2f-4564-a1a8-c00b0be58c8d","9bd180ed-be0a-4ca3-bc06-f7eaf6c0eda3","31d6bc98-ef45-444e-991c-78db085fff56","5d1c9bf8-20e0-4d04-a7dc-ef776fa34d20","9f53b1b3-1947-4383-a59b-c304f529171a","694d60f4-2b89-4637-a315-df7962afae5c","e64ab419-b8c9-4c95-9929-33b088e77c84","38b42bba-77d8-4d27-ab85-f67f9ee72ef3","fcdba541-dedc-42bf-b3e3-c85b39bc5c92","3a8fa13a-6256-4e07-a95c-5bfd6238e8a9","04bb803b-c050-4251-b23c-f3ea96cfeb2b","d4d3f108-0d5f-4e46-947f-f12be6afbefb","359da2ef-ac8f-42bb-a6cd-70079a8daf46","bbc1b7c6-bca2-4820-bd50-38e97a205f13","81e443d2-4ae8-49f0-a8d0-95f1b619663d","ce7f8c20-411f-4ffc-be2e-74aabec8f790","b3171dcf-c377-44ec-a6e4-25d3ff67541e","ccceceef-130e-498d-8409-18bc769bcdcf","343839d5-0860-4431-8285-98efbaa47b09","09131752-b13f-4761-89ba-756c19bc7488","e8728958-99f9-4c09-8a02-a12e867a23c5","8b617ef9-b8ba-48b4-baf2-22b4b95558b0","8518db40-c531-43bd-a385-2e28e0d87d6c","b4e2c437-b683-44dd-99c9-fd18021053cf","e24c42b5-aa0e-4d0c-b568-21db25df6ca2","8b55a652-ddc9-491e-9fa4-586c787f5660","27cc1ee6-8a50-437a-8f5a-2a011ac971cc","5d371e13-90e4-4838-bc08-b746c5dec122","332cec75-bf42-4e74-a96e-fbb51ed5d91c","5b50f8d1-3a62-40ca-94b2-b2c595b23fcb","b162be93-a292-4cf4-9538-8b8ed88478cd","a53b318d-85f0-496f-98ef-84754c4d0db6","4adef2d0-9801-4357-86d9-f22e00963f78","e97fba1e-89b8-4382-81dd-9c12b279254b","886f93ef-fe37-44b0-854d-5128c91526d0","e675b525-e4e5-4259-84bc-a0d9a2af9d5d","cc811d44-2bc4-49ee-b1d1-b9daea87ef23","6ea379d6-54e5-407c-93ab-7a064f1af616","a5c5cf48-ac00-41e8-b7f4-27182a23da1c","4c441bb6-d909-481a-b2dc-2242fb2dc9d6","bf40eb18-ccd4-48bd-a686-875a3db705f4","01a7e71b-5059-47de-b2cb-eea9d27b20c7","edd4ab66-74eb-425a-a924-5f93e21da029","933e04be-294f-4d59-b818-441fb844e01b","0ca8da15-b918-4b0a-aab0-eee6a29a08f5","8975fd38-7f84-43c6-a422-1f17eb72ca6c","6a8faf93-ba85-44dc-a91a-c508e1defe91","6afb8c8a-9184-46b6-a3f6-5447018aad45","356abe22-78ce-4822-b8ca-b9ffbd38a660","0858e5ed-f4a2-470f-8d35-3bc0aba89fa9","87d64bed-71c3-4494-8cd5-0a64e3ba8923","8afc0a81-7db5-4b25-95e1-ce46d0597c13","2d95e99e-41ef-400d-ac89-9f1546eefd8a","86ac0f1f-a87e-44f6-83a8-b2bdb530a19b","ed4e621f-982b-438d-8982-53d6fd0d203d","d190ee16-bdcd-42fd-aa0f-74f69e98344f","c39b12d8-c36a-44c3-be07-d416d89e3766","40a2bced-ad45-41fb-8c41-0a00fd22c3ac","b02011f0-e901-4d2c-8f5d-2e3c460d3c72","24111fb8-81f5-4498-81c0-a7a6304a9f25"]}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"LINE","Confidence":99.8729019165039,"Text":"CITY OF ATTLEBORO, MASSACHUSETTS","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.328200131654739,"Height":0.0120920054614544,"Left":0.347566157579422,"Top":0.0480296947062016},"Polygon":[{"X":0.347566157579422,"Y":0.0480296947062016},{"X":0.675766289234161,"Y":0.0480296947062016},{"X":0.675766289234161,"Y":0.0601217001676559},{"X":0.347566157579422,"Y":0.0601217001676559}]},"Id":"b089f2d8-44e3-4432-a1e6-0d4c457bf25c","Relationships":[{"Type":"CHILD","Ids":["a2bb7c52-fb0a-4ec7-9afa-a8e7c2a61f9c","5b6a20de-f76a-414b-a2fc-46b313270ea4","263aed17-f850-4ed4-a314-59f4430e1b56","049b0693-c95b-48e3-a0cf-ada27e41f69c"]}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"LINE","Confidence":90.2096252441406,"Text":"Balance Sheets - Governmental Funds","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.249993175268173,"Height":0.0105019323527813,"Left":0.386319369077682,"Top":0.0618089847266674},"Polygon":[{"X":0.386319369077682,"Y":0.0618089847266674},{"X":0.636312544345856,"Y":0.0618089847266674},{"X":0.636312544345856,"Y":0.0723109170794487},{"X":0.386319369077682,"Y":0.0723109170794487}]},"Id":"65722cda-71e9-49a8-a809-493e27e6ecec","Relationships":[{"Type":"CHILD","Ids":["05221e6d-3b71-4c38-a082-8d795afb9b92","6ade6492-af51-42d9-9d6a-d21515d1b3d9","fb61da96-98db-47a6-bb67-80c042ad9f98","3a1d995e-d833-4e13-b281-a180782a9a41","98bafe2e-89fe-45b3-92c2-385851ddacb2"]}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"LINE","Confidence":99.7061462402344,"Text":"June 30, 2018","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0914927572011948,"Height":0.0110378693789244,"Left":0.46528360247612,"Top":0.0768411457538605},"Polygon":[{"X":0.46528360247612,"Y":0.0768411457538605},{"X":0.556776344776154,"Y":0.0768411457538605},{"X":0.556776344776154,"Y":0.08787901699543},{"X":0.46528360247612,"Y":0.08787901699543}]},"Id":"6a8eb039-837c-4ca3-a31f-59a49e8ab078","Relationships":[{"Type":"CHILD","Ids":["93dd68bd-ab5a-4d3c-9ad3-ba0e757e29d8","2b15c485-4583-421d-83f3-cc004724dcfd","8c47f6f2-9f27-442d-9465-deb517a2014b"]}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"LINE","Confidence":99.8734436035156,"Text":"Major Fund","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0682311207056046,"Height":0.00993594620376825,"Left":0.515842616558075,"Top":0.141945227980614},"Polygon":[{"X":0.515842616558075,"Y":0.141945227980614},{"X":0.584073722362518,"Y":0.141945227980614},{"X":0.584073722362518,"Y":0.151881173253059},{"X":0.515842616558075,"Y":0.151881173253059}]},"Id":"9ac624ae-fc16-4435-a5df-8c5b4eda0739","Relationships":[{"Type":"CHILD","Ids":["80d96678-fa64-4b95-bb2f-6db69ffa46b8","0b49a9b3-ac7b-485c-881b-f8bdcb8dca39"]}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"LINE","Confidence":99.8324737548828,"Text":"Non-Major","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0642843842506409,"Height":0.00987696647644043,"Left":0.632385730743408,"Top":0.142111480236053},"Polygon":[{"X":0.632385730743408,"Y":0.142111480236053},{"X":0.696670114994049,"Y":0.142111480236053},{"X":0.696670114994049,"Y":0.151988446712494},{"X":0.632385730743408,"Y":0.151988446712494}]},"Id":"50f4b8b4-92c0-4b33-af5b-d94d247cb957","Relationships":[{"Type":"CHILD","Ids":"2dc4e328-f7a4-4beb-883b-8c6866af060c"}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"LINE","Confidence":99.8507385253906,"Text":"Total","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0291486978530884,"Height":0.00818844139575958,"Left":0.756369709968567,"Top":0.141900286078453},"Polygon":[{"X":0.756369709968567,"Y":0.141900286078453},{"X":0.785518407821655,"Y":0.141900286078453},{"X":0.785518407821655,"Y":0.150088727474213},{"X":0.756369709968567,"Y":0.150088727474213}]},"Id":"0f77a203-68cc-4112-8ed4-3971908ba640","Relationships":[{"Type":"CHILD","Ids":"f37a7fc8-f467-429f-a433-95049cdf61e8"}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"LINE","Confidence":99.9212188720703,"Text":"General","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0465574860572815,"Height":0.0081067681312561,"Left":0.526444971561432,"Top":0.155113011598587},"Polygon":[{"X":0.526444971561432,"Y":0.155113011598587},{"X":0.573002457618713,"Y":0.155113011598587},{"X":0.573002457618713,"Y":0.163219779729843},{"X":0.526444971561432,"Y":0.163219779729843}]},"Id":"36aabd47-5dc4-421c-aded-053b3809bec1","Relationships":[{"Type":"CHILD","Ids":"14ce8d00-87e2-4662-ab32-82cbbf076ed1"}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"LINE","Confidence":99.8980407714844,"Text":"Governmental","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0821431279182434,"Height":0.00816278159618378,"Left":0.623451232910156,"Top":0.155176013708115},"Polygon":[{"X":0.623451232910156,"Y":0.155176013708115},{"X":0.7055943608284,"Y":0.155176013708115},{"X":0.7055943608284,"Y":0.163338795304298},{"X":0.623451232910156,"Y":0.163338795304298}]},"Id":"82fe59aa-fc01-437f-8c2e-292702a1647f","Relationships":[{"Type":"CHILD","Ids":"ca139efd-6492-457c-9e8a-46a70b7802ef"}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"LINE","Confidence":99.7160110473633,"Text":"Governmental","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0823081135749817,"Height":0.00805313885211945,"Left":0.729603290557861,"Top":0.155253916978836},"Polygon":[{"X":0.729603290557861,"Y":0.155253916978836},{"X":0.811911404132843,"Y":0.155253916978836},{"X":0.811911404132843,"Y":0.163307055830956},{"X":0.729603290557861,"Y":0.163307055830956}]},"Id":"c936eb95-fde0-48c2-ae8b-9475af61f6f2","Relationships":[{"Type":"CHILD","Ids":"93f2d7be-770d-4359-a05e-6f6d9549e8fb"}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"LINE","Confidence":99.6132431030273,"Text":"23","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0162584781646729,"Height":0.00991564989089966,"Left":0.877289533615112,"Top":0.94217586517334},"Polygon":[{"X":0.877289533615112,"Y":0.94217586517334},{"X":0.893548011779785,"Y":0.94217586517334},{"X":0.893548011779785,"Y":0.95209151506424},{"X":0.877289533615112,"Y":0.95209151506424}]},"Id":"b02011f0-e901-4d2c-8f5d-2e3c460d3c72","Relationships":[{"Type":"CHILD","Ids":"9f81dd98-2e65-4ce8-b3da-d9d9fe836b9a"}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"WORD","Confidence":99.8464279174805,"Text":"CITY","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0402611792087555,"Height":0.0097391651943326,"Left":0.347566157579422,"Top":0.0480296947062016},"Polygon":[{"X":0.347566157579422,"Y":0.0480296947062016},{"X":0.387827336788177,"Y":0.0480296947062016},{"X":0.387827336788177,"Y":0.0577688589692116},{"X":0.347566157579422,"Y":0.0577688589692116}]},"Id":"a2bb7c52-fb0a-4ec7-9afa-a8e7c2a61f9c","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"WORD","Confidence":99.8058242797852,"Text":"OF","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0223059002310038,"Height":0.00958989374339581,"Left":0.392359346151352,"Top":0.0481834784150124},"Polygon":[{"X":0.392359346151352,"Y":0.0481834784150124},{"X":0.414665251970291,"Y":0.0481834784150124},{"X":0.414665251970291,"Y":0.0577733740210533},{"X":0.392359346151352,"Y":0.0577733740210533}]},"Id":"5b6a20de-f76a-414b-a2fc-46b313270ea4","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"WORD","Confidence":99.9326400756836,"Text":"ATTLEBORO,","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.107775151729584,"Height":0.011679220944643,"Left":0.418294250965118,"Top":0.0484424829483032},"Polygon":[{"X":0.418294250965118,"Y":0.0484424829483032},{"X":0.526069402694702,"Y":0.0484424829483032},{"X":0.526069402694702,"Y":0.0601217038929462},{"X":0.418294250965118,"Y":0.0601217038929462}]},"Id":"263aed17-f850-4ed4-a314-59f4430e1b56","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"WORD","Confidence":99.9067230224609,"Text":"MASSACHUSETTS","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.14466156065464,"Height":0.00988541170954704,"Left":0.531104743480682,"Top":0.0481386780738831},"Polygon":[{"X":0.531104743480682,"Y":0.0481386780738831},{"X":0.675766289234161,"Y":0.0481386780738831},{"X":0.675766289234161,"Y":0.0580240897834301},{"X":0.531104743480682,"Y":0.0580240897834301}]},"Id":"049b0693-c95b-48e3-a0cf-ada27e41f69c","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"WORD","Confidence":99.9431304931641,"Text":"Balance","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0523790083825588,"Height":0.00984100997447968,"Left":0.386319369077682,"Top":0.0619753412902355},"Polygon":[{"X":0.386319369077682,"Y":0.0619753412902355},{"X":0.438698381185532,"Y":0.0619753412902355},{"X":0.438698381185532,"Y":0.0718163475394249},{"X":0.386319369077682,"Y":0.0718163475394249}]},"Id":"05221e6d-3b71-4c38-a082-8d795afb9b92","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"WORD","Confidence":99.4727172851562,"Text":"Sheets","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0427423417568207,"Height":0.010501935146749,"Left":0.442787200212479,"Top":0.0618089847266674},"Polygon":[{"X":0.442787200212479,"Y":0.0618089847266674},{"X":0.485529541969299,"Y":0.0618089847266674},{"X":0.485529541969299,"Y":0.0723109170794487},{"X":0.442787200212479,"Y":0.0723109170794487}]},"Id":"6ade6492-af51-42d9-9d6a-d21515d1b3d9","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"WORD","Confidence":52.0821380615234,"Text":"-","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.00572196999564767,"Height":0.00258046993985772,"Left":0.489485532045364,"Top":0.0671662613749504},"Polygon":[{"X":0.489485532045364,"Y":0.0671662613749504},{"X":0.495207488536835,"Y":0.0671662613749504},{"X":0.495207488536835,"Y":0.069746732711792},{"X":0.489485532045364,"Y":0.069746732711792}]},"Id":"fb61da96-98db-47a6-bb67-80c042ad9f98","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"WORD","Confidence":99.9017562866211,"Text":"Governmental","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0939368978142738,"Height":0.00983215030282736,"Left":0.498926401138306,"Top":0.0621132105588913},"Polygon":[{"X":0.498926401138306,"Y":0.0621132105588913},{"X":0.592863321304321,"Y":0.0621132105588913},{"X":0.592863321304321,"Y":0.0719453617930412},{"X":0.498926401138306,"Y":0.0719453617930412}]},"Id":"3a1d995e-d833-4e13-b281-a180782a9a41","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"WORD","Confidence":99.6483993530273,"Text":"Funds","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0394137389957905,"Height":0.00992638245224953,"Left":0.596898794174194,"Top":0.0620685778558254},"Polygon":[{"X":0.596898794174194,"Y":0.0620685778558254},{"X":0.636312544345856,"Y":0.0620685778558254},{"X":0.636312544345856,"Y":0.071994960308075},{"X":0.596898794174194,"Y":0.071994960308075}]},"Id":"98bafe2e-89fe-45b3-92c2-385851ddacb2","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"WORD","Confidence":99.6132431030273,"Text":"23","RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.0162584707140923,"Height":0.00991563033312559,"Left":0.877289533615112,"Top":0.94217586517334},"Polygon":[{"X":0.877289533615112,"Y":0.94217586517334},{"X":0.893548011779785,"Y":0.94217586517334},{"X":0.893548011779785,"Y":0.95209151506424},{"X":0.877289533615112,"Y":0.95209151506424}]},"Id":"9f81dd98-2e65-4ce8-b3da-d9d9fe836b9a","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"TABLE","Confidence":99.999870300293,"Text":[],"RowIndex":[],"ColumnIndex":[],"RowSpan":[],"ColumnSpan":[],"Geometry":{"BoundingBox":{"Width":0.637475669384003,"Height":0.750814855098724,"Left":0.188179790973663,"Top":0.125344067811966},"Polygon":[{"X":0.188179790973663,"Y":0.125344067811966},{"X":0.825655460357666,"Y":0.125344067811966},{"X":0.825655460357666,"Y":0.876158952713013},{"X":0.188179790973663,"Y":0.876158952713013}]},"Id":"24111fb8-81f5-4498-81c0-a7a6304a9f25","Relationships":[{"Type":"CHILD","Ids":["b6333dc3-3968-4834-b721-92b436aaf855","96766689-e45c-4c52-ba19-bff1609ec291","04823ba1-1509-4c2a-958c-6d5bd30b84d5","59b270dc-fc40-486f-8390-719f6a22d4bf","3b51488d-b221-44a2-8829-b82e98b760bf","e7ae5912-4740-4b9b-abcc-f5dcd63ee16e","6ddf6258-2ef6-430a-b84a-2af3758b2e0f","7a60056a-1799-44de-ba13-33ac46fc0f6b","a041e0e3-2441-41bd-9305-c1364b89cb46","9e25f573-339b-4fff-9059-3f261f6bfe77","9f6a6451-38f7-4d34-95eb-4e26e4620af7","1b8ac72e-82de-4585-95aa-c8020158f036","0952d71a-9326-47e0-b4a5-bbfcf2bf6846","b18fb2df-fb57-414a-9470-84a3c1f48db6","8ff0c622-c628-492c-bb6c-22a6c373e316","e93c896b-52e1-44f1-bcea-3388f5fa1f00","aac0434d-4c9b-4e79-bdf2-aff4b72dc28f","a6d4ba12-24b0-4a1a-b014-6a9e1dbbf8e1","a2f960d6-7206-4c92-8237-4643e23eba64","6c965beb-ec5e-42e9-b7f8-562f4b5725c2","7f4d67c0-4cdf-4aa3-b2ce-d868ea23ce6d","0b32d117-7cce-489c-85d3-1a9dbb14faf2","eb797cff-8885-4f57-bdef-079fa18c54fc","c01d88c2-3732-4e4d-a0bc-1f7bf601917c","7eb12d0b-6293-4db1-a27a-ce3cd5679c0a","7a7686e3-8503-4e48-90ea-cbb2b8d5cca8","3b94e10c-5dcc-4ced-830d-2d895229ff0d","0e9bd28d-019c-455c-b374-b6d6d48f6d21","63d60647-3154-4e0a-b702-73ade8458316","b1f93ffc-2a1a-4997-9b0e-2c519feec3ff","e9f0a060-0765-4a48-a4a9-accd7c04284e","e3d27ecc-8869-4de7-9bab-bcb46d343523","2eccdf78-4fe8-47a3-b6ae-d5cd21bc3886","03f06bf7-2cfa-4669-903c-583537cdc161","434e1279-2f2f-415e-a489-050e892bf7b9","02d5bfef-5584-40be-b179-6e9d2537756c","8d187091-d5e0-4213-97ae-9f62b22e3e4f","1bc54d9b-89c4-4534-872a-33131be3f251","329c022d-bf41-4f80-bca6-34c71b25e168","e65b7d40-277a-49fd-af5b-d26ff96d34ea","05f1b05f-101a-4f35-aa1a-1ebdb2d94c26","575ee3fa-41a9-4e08-a919-75d66e4a16db","d55c92a0-069f-42d8-9f26-acffd62dde01","4b45d739-f2f5-41a1-bc1b-6b3d328c0d44","1d2184a9-8585-4158-9ceb-2fc216041a7c","0301be71-5c2f-4c84-a9e3-32ea34ca7bfb","6cf0be98-ccca-412f-a24a-9d82af033dcc","5c2e31a1-109d-4a66-88b6-fbc15dbf152b","ffa5d806-7777-42e4-bb1d-0cc19c188846","28138391-1238-4ea5-9bef-11051cf7d621","e16b33c0-dfaf-4db9-970b-92072663a983","bf5957d2-9f3b-470d-afdb-3083ee5305f5","932f5ffa-48a6-4e1e-82e4-4ee79ea2101a","f7902096-7282-4dae-b70e-b048d9bdaf63","e5a059fa-7a34-4215-9e96-6c0d5e9fbfd3","682d8972-3711-4e28-85f4-4ff80e858470","77daeba5-f56a-494d-b3dd-984282e4c5b6","661d087c-a506-4d70-ac8a-ba37820bf0e3","00cde15a-59b4-4952-98de-d541563c425c","7ba81099-50df-452a-9ec2-b1aff4d64987","18e0d302-0b26-41fc-82e6-a46cfd2cc2cd","be0257d1-806b-4a19-ae12-fc3f93dcd24f","5cbb9368-7ed4-4408-aa7b-cbeae6e366a5","09a23324-10ad-47fa-a0b0-55dffc6fdf58","063688d5-49ef-4c4c-be3a-2afc09a05438","8d7b699a-df3d-4db2-a860-1dd0d87e3220","b94adece-3d77-42dd-9316-8ec4abfd865a","8e3473b5-6e72-4481-8874-c4475b8a8c9a","c14333a0-7f40-4823-bc61-8f4a1a1e7ca3","98f14efb-a1db-46bb-a3c0-cf1f67cc0999","2947f92a-e1de-4518-b36a-0b47f204d28e","8a9c9412-b7bb-4c76-84de-0bf125c317e6","9c43aeb7-9f4c-4f14-bacb-7ac1e5d395c5","9f29470c-a5a2-403c-944e-0f03364b4376","d207b538-27b9-43b0-90d0-72615fefac88","06accd48-fdb7-434a-929f-8cc9f744d7cd","afe87c59-bedf-48b4-bdca-f56a9866d003","49cbf199-1adf-4ad6-b811-d59f87400c35","5435ef1b-0857-48e7-8368-2a12b3e78f3e","3d3e24c9-7fbf-41cd-b404-b8089add1a72","7cb616ff-3072-43dc-9072-38356290e5e4","986b16b4-c5be-41b6-bda7-ac186f141ab6","f83a46ac-e1b3-4f15-a5d7-ace327c78241","b5770db0-22b4-4ebf-a4bf-42532a6d9a3f","9530f5cc-bf1c-4f38-90ee-2d660788a9f2","2c10d344-d3ba-48ea-84b9-5605bc1104a0","0a30cba0-1ef0-4e96-a080-fc39a445a14c","82ff4103-99a6-4e15-bfd9-a3906072414e","82804d28-8baa-4608-8b13-594ebd419d17","8d9763dc-0865-4554-af54-06691445fabc","449c3cb2-3d8f-4ba1-866c-d411e212eda4","3e9742c2-c66d-4a89-a7b3-7fea54bb948b","9f85e1e7-d887-46f5-baa0-7875b8a4ec4e","3356a86d-2c5b-42cc-a499-70aae92ae848","922ca6c0-c5f5-4ec1-846f-6ead0fa26888","127b6a11-10ff-4389-9871-3acf56b1ab7d","282406f9-90d9-439c-9427-c2c2d483b5e1","d6d8a5ac-7cb4-4583-bb5e-ab68b69777f7","37c4215b-5b72-4d07-b718-4f91ec956a45","1bc0d132-6a15-4869-bdfd-bec879b25c65","ced28da4-3d12-49de-8b32-493002a2fcdf","7defc824-26d2-4ad1-8e99-af01f6b9ab6d","85433b02-fce8-446c-987e-67476a87466e","0b460820-ab7f-42da-9cc6-6ab51a18557e","44418fb4-536c-4271-b81c-f6e077363be6","f9ca58ce-eaad-4959-8f82-81b8fe7ac55e","c1ce2dde-f9c6-447c-922d-1da17d87cb4c","1bb840b0-2a3d-41a7-8915-71e05e449821","be2d251e-161e-4cb3-9838-25bc09fad742","25a7838c-6751-42cc-90aa-d0e7db945d78","e4903b4d-89fe-419d-996d-a08af940bf50","f42ffc68-7351-4f31-8d3b-b43e3c136804","8e3735d8-86d4-4fd1-8a38-b81f8dc15038","1e98a034-af50-4907-9d7d-a186d774c5d0","5c239f84-df7b-411b-9673-30a2ec2ab416","e4a93acc-4447-4c3a-b86f-caf1e4fd131c","82aad07f-9ba3-43bb-af5f-dff145804ab0","aa9177fa-08e8-4428-8d58-64e47f824a88","96a78919-540f-4519-825f-5a67a7b98731","876150fb-ccdb-4162-9b7d-10d17f975652","7382672d-2c28-4ab0-9f26-f7df573df783","15f373fd-db6c-407b-9759-03cb46a83c4e","107177c1-5cb5-4ac3-913b-6c8cf63b18d9","5071991a-fda2-4f47-8f87-d767c5760e49","5135cd7d-abbb-4bd4-8ab1-06aa69585efd","43f60857-246c-4a3a-abf6-e9324767232e","12a31e61-f482-4a7c-9339-b27b9975707b","06707bde-9565-492f-a50f-aa6926b09006","4b4fa161-67d5-45ca-a3a0-dc72788c3acb","b71c55dc-4158-49a5-b49c-fc095b77b6a1","17c8a099-030c-43f5-bd79-d3f714bb655d","d35d1830-0908-43e9-abf9-6af896d35f2d","b9417312-345b-4022-91c0-51e3dfb1417d","2076ae2a-53b1-4f63-a95c-e5a1097444b3","35853737-8f80-45d3-adbe-c13637d99a03","4b50d52e-3a4b-4f10-92b0-59e1b9d9d03d","e6f6d574-080d-4e1c-bde0-78e9e261a249","baa77b5d-5729-4830-91e3-251a7b8d48d1","2f1bc8ef-a0a2-4eab-a77e-d897a47d11a8","d166817f-3576-4a06-9c73-441435f3adfb","c7116374-97df-4c42-9ce4-c3b68590e50e","36902777-f17a-4b08-bcc6-ae641abfd850","d2297049-ceda-4c50-8b53-f70c8a0d856e","d58fecb4-44de-4a50-8306-7628aa94a882","67198594-0554-4b5b-bf1d-acd4f3527463","da40b5c4-6de5-4023-a4da-6fce0f18e074","986e0e70-c771-4416-9d6a-de5af4955e3d","31ca7198-9cc7-49ee-8206-f01983057c43","18a61d6a-9fe7-4727-8078-3a1e588c6b43","4d5d4501-54b6-4fdc-8cf0-57dac3666e92","c2fc7bf7-8a94-4d74-9377-334323bbea9e","4d63bfb1-40e4-4f7b-90f4-454dc50949ce","5b550b9d-e51b-480c-922b-6b3a559102f8","8e778a38-cb5a-4776-9b66-9c07a81852ef","fa3254ab-26d6-49b5-984d-9543d9f15ffe","ffdf74b4-0e51-45c7-998b-8641f6dff294","f45787a2-d6b9-49d1-ab3f-38d4b8fa4f61","d5941a46-46dd-4936-83a8-f115fd7b4c30","d6aad149-5488-4743-9761-21dc5de022d0","8cd06552-c9d6-4418-88bd-3043ff824c3d","164f3aa8-f362-42ae-a4ba-c9d116d28101","cf9dd2a6-682a-453e-bf6b-98d5ec3913c1","e4bcf953-f312-401c-8c78-78df31a41f5e","f79bf547-51ad-4ae0-92ff-2ed8684dd4d6","25f3945c-1d69-460a-b701-be72d2899d49","96c41cf9-c273-471c-9376-6fc3dea8ad7e","380ad072-bc4a-4819-8002-fa4cfca6ef08","d0dfa72a-14e7-4196-8c31-2f52ef0b824b"]}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"CELL","Confidence":99.999870300293,"Text":[],"RowIndex":1,"ColumnIndex":1,"RowSpan":1,"ColumnSpan":1,"Geometry":{"BoundingBox":{"Width":0.308777272701263,"Height":0.026814816519618,"Left":0.188179790973663,"Top":0.152158886194229},"Polygon":[{"X":0.188179790973663,"Y":0.152158886194229},{"X":0.496957063674927,"Y":0.152158886194229},{"X":0.496957063674927,"Y":0.178973704576492},{"X":0.188179790973663,"Y":0.178973704576492}]},"Id":"b6333dc3-3968-4834-b721-92b436aaf855","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"CELL","Confidence":99.999870300293,"Text":[],"RowIndex":1,"ColumnIndex":2,"RowSpan":1,"ColumnSpan":1,"Geometry":{"BoundingBox":{"Width":0.11383493989706,"Height":0.026814816519618,"Left":0.496957063674927,"Top":0.152158886194229},"Polygon":[{"X":0.496957063674927,"Y":0.152158886194229},{"X":0.610791981220245,"Y":0.152158886194229},{"X":0.610791981220245,"Y":0.178973704576492},{"X":0.496957063674927,"Y":0.178973704576492}]},"Id":"96766689-e45c-4c52-ba19-bff1609ec291","Relationships":[{"Type":"CHILD","Ids":["14ce8d00-87e2-4662-ab32-82cbbf076ed1","5633833c-8c30-462f-9559-ff6025e1eda4"]}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"CELL","Confidence":99.999870300293,"Text":[],"RowIndex":1,"ColumnIndex":3,"RowSpan":1,"ColumnSpan":1,"Geometry":{"BoundingBox":{"Width":0.106720253825188,"Height":0.026814816519618,"Left":0.610791981220245,"Top":0.152158886194229},"Polygon":[{"X":0.610791981220245,"Y":0.152158886194229},{"X":0.717512249946594,"Y":0.152158886194229},{"X":0.717512249946594,"Y":0.178973704576492},{"X":0.610791981220245,"Y":0.178973704576492}]},"Id":"04823ba1-1509-4c2a-958c-6d5bd30b84d5","Relationships":[{"Type":"CHILD","Ids":["ca139efd-6492-457c-9e8a-46a70b7802ef","2dd22ecb-00de-4d66-ad2b-5886a2049fb8"]}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"CELL","Confidence":99.999870300293,"Text":[],"RowIndex":1,"ColumnIndex":4,"RowSpan":1,"ColumnSpan":1,"Geometry":{"BoundingBox":{"Width":0.108143195509911,"Height":0.026814816519618,"Left":0.717512249946594,"Top":0.152158886194229},"Polygon":[{"X":0.717512249946594,"Y":0.152158886194229},{"X":0.825655460357666,"Y":0.152158886194229},{"X":0.825655460357666,"Y":0.178973704576492},{"X":0.717512249946594,"Y":0.178973704576492}]},"Id":"59b270dc-fc40-486f-8390-719f6a22d4bf","Relationships":[{"Type":"CHILD","Ids":["93f2d7be-770d-4359-a05e-6f6d9549e8fb","76c6634a-c2df-4ae5-a394-ac2275cf630b"]}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"CELL","Confidence":99.999870300293,"Text":[],"RowIndex":2,"ColumnIndex":1,"RowSpan":1,"ColumnSpan":1,"Geometry":{"BoundingBox":{"Width":0.308777272701263,"Height":0.0251388903707266,"Left":0.188179790973663,"Top":0.178973704576492},"Polygon":[{"X":0.188179790973663,"Y":0.178973704576492},{"X":0.496957063674927,"Y":0.178973704576492},{"X":0.496957063674927,"Y":0.204112589359283},{"X":0.188179790973663,"Y":0.204112589359283}]},"Id":"3b51488d-b221-44a2-8829-b82e98b760bf","Relationships":[{"Type":"CHILD","Ids":"8741c8c9-642e-497f-b4df-9f79e4d62d9d"}],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"CELL","Confidence":99.999870300293,"Text":[],"RowIndex":2,"ColumnIndex":2,"RowSpan":1,"ColumnSpan":1,"Geometry":{"BoundingBox":{"Width":0.11383493989706,"Height":0.0251388903707266,"Left":0.496957063674927,"Top":0.178973704576492},"Polygon":[{"X":0.496957063674927,"Y":0.178973704576492},{"X":0.610791981220245,"Y":0.178973704576492},{"X":0.610791981220245,"Y":0.204112589359283},{"X":0.496957063674927,"Y":0.204112589359283}]},"Id":"e7ae5912-4740-4b9b-abcc-f5dcd63ee16e","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"CELL","Confidence":99.999870300293,"Text":[],"RowIndex":2,"ColumnIndex":3,"RowSpan":1,"ColumnSpan":1,"Geometry":{"BoundingBox":{"Width":0.106720253825188,"Height":0.0251388903707266,"Left":0.610791981220245,"Top":0.178973704576492},"Polygon":[{"X":0.610791981220245,"Y":0.178973704576492},{"X":0.717512249946594,"Y":0.178973704576492},{"X":0.717512249946594,"Y":0.204112589359283},{"X":0.610791981220245,"Y":0.204112589359283}]},"Id":"6ddf6258-2ef6-430a-b84a-2af3758b2e0f","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]},{"BlockType":"CELL","Confidence":99.999870300293,"Text":[],"RowIndex":2,"ColumnIndex":4,"RowSpan":1,"ColumnSpan":1,"Geometry":{"BoundingBox":{"Width":0.108143195509911,"Height":0.0251388903707266,"Left":0.717512249946594,"Top":0.178973704576492},"Polygon":[{"X":0.717512249946594,"Y":0.178973704576492},{"X":0.825655460357666,"Y":0.178973704576492},{"X":0.825655460357666,"Y":0.204112589359283},{"X":0.717512249946594,"Y":0.204112589359283}]},"Id":"7a60056a-1799-44de-ba13-33ac46fc0f6b","Relationships":[],"EntityTypes":[],"SelectionStatus":[],"Page":[]}],"options":{"mode":"tree","modes":["code","form","text","tree","view"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="parsing-the-response-object-with-reticulated-python" class="section level1">
<h1>Parsing the Response Object with Reticulated Python</h1>
<p>An increasing amount is being written on how to use <code>reticulate</code> to run Python code from RStudio, so we won’t get into great detail here about how to set it up here. It took us a long time to understand how to set up our environment, but as this case shows, it is probably going to be worth it to switch back and forth to take advantage of the strengths of the two languages. We used Python 3.7 with miniconda after re-installing Anaconda post the recent upgrade to Catalina, in which Apple re-arranged our whole set-up.</p>
<pre class="r"><code># Choose Python 3.7 miniconda
reticulate::use_condaenv(
  condaenv = &quot;r-miniconda&quot;, 
  conda = &quot;/Users/davidlucey/opt/anaconda3/bin/conda&quot;, 
  required = TRUE
  )</code></pre>
<p>AWS gives the Python code to parse the blocks back into a tabular form [Textract Python Table Parser] (<a href="https://github.com/awsdocs/aws-doc-sdk-examples/blob/master/python/example_code/textract/textract_python_table_parser.py" class="uri">https://github.com/awsdocs/aws-doc-sdk-examples/blob/master/python/example_code/textract/textract_python_table_parser.py</a>). This code built in the call to AWS with the Python boto client from the command line, but we didn’t need these functions, so we had to modify to take already returned response straight from our RStudio environment.</p>
<p>A second problem that we encountered was that when the response object was read into Python from R, blocks which had multiple children <code>Ids</code> were converted to list, while those with single children were stored as strings. It took some time, we patched this in the <code>get_text()</code> function below by converting the strings to single item lists, so it should work for any R user now. We noted where we made modifications with comments below.</p>
<pre class="python"><code>
import webbrowser, os
import json
import io
from io import BytesIO
import sys


def get_rows_columns_map(table_result, blocks_map):
    rows = {}
    for relationship in table_result[&#39;Relationships&#39;]:
        if relationship[&#39;Type&#39;] == &#39;CHILD&#39;:
            for child_id in relationship[&#39;Ids&#39;]:
                cell = blocks_map[child_id]
                if cell[&#39;BlockType&#39;] == &#39;CELL&#39;:
                    row_index = cell[&#39;RowIndex&#39;]
                    col_index = cell[&#39;ColumnIndex&#39;]
                    if row_index not in rows:
                        # create new row
                        rows[row_index] = {}
                        
                    # get the text value
                    rows[row_index][col_index] = get_text(cell, blocks_map)
    return rows

def get_text(result, blocks_map):
    text = &#39;&#39;
    if &#39;Relationships&#39; in result:
        for relationship in result[&#39;Relationships&#39;]:
            if relationship[&#39;Type&#39;] == &#39;CHILD&#39;:
                if isinstance(relationship[&#39;Ids&#39;], str):     # Modified here
                    relationship_ids = [relationship[&#39;Ids&#39;]]
                else: 
                    relationship_ids = relationship[&#39;Ids&#39;]
                for child_id in relationship_ids:
                    word = blocks_map[child_id]
                    if word[&#39;BlockType&#39;] == &#39;WORD&#39;:
                        text += word[&#39;Text&#39;] + &#39; &#39;
                        
    return text

def get_table_csv_results(response):
    blocks = response[&#39;Blocks&#39;] # Modified here
    blocks_map = {}
    table_blocks = []
    for block in blocks:
        blocks_map[block[&#39;Id&#39;]] = block
        if block[&#39;BlockType&#39;] == &quot;TABLE&quot;:
            table_blocks.append(block)
            
    if len(table_blocks) &lt;= 0:
        return &quot;&lt;b&gt; NO Table FOUND &lt;/b&gt;&quot;
        
    csv = &#39;&#39;
    for index, table in enumerate(table_blocks):
        csv += generate_table_csv(table, blocks_map, index +1)
        csv += &#39;\n\n&#39;
    return csv

def generate_table_csv(table_result, blocks_map, table_index):
    rows = get_rows_columns_map(table_result, blocks_map)
    table_id = &#39;Table_&#39; + str(table_index)
    # get cells.
    csv = &#39;Table: {0}\n\n&#39;.format(table_id)
    for row_index, cols in rows.items():
        for col_index, text in cols.items():
            csv += &#39;{}&#39;.format(text) + &quot;\t&quot;
        csv += &#39;\n&#39;
    csv += &#39;\n\n\n&#39;
    return csv

# Removed main()</code></pre>
<p>We called our Python <code>get_table_csv_results()</code> function from <code>reticulate</code> (as <code>py$get_table_csv_results()</code>) and show the raw parsed unparsed text below. We will not show the clean up of the raw text string here, but this also involves still some complicated regulaar expressions. Please refer to our Github repo for the code we used.</p>
<pre class="r"><code># Call Python function above from R
page &lt;- py$get_table_csv_results(response)

# Print text
cat(page)</code></pre>
<pre><code>Table: Table_1

    General Fund    Governmental Funds  Governmental Funds  
Assets              
Cash and investments -- unrestricted    $ 9,663,898     $ 21,470,155    $ 31,134,053    
Cash and investments - restricted (for stabilization                
purposes)   3,172,925   -   3,172,925   
Receivables:                
Property taxes  1,266,214   --  1,266,214   
Motor vehicle excise    879,694     -   879,694     
Tax liens and foreclosures  2,110,587   --  2,110,587   
User charges    557,376     --  557,376     
Intergovernmenta    160,060     2,728,377   2,888,437   
Other   5,584,192   2,184,952   7,769,144   
Due from ARA    616,048     --  616,048     
Total assets    24,010,994  26,383,484  50,394,478  
Deferred outflows of resources              
None    -   --  -   
Total deferred outflows of resources    -   --  -   
Total assets and deferred outflows of resources     $ 24,010,994    $ 26,383,484    $ 50,394,478    
Liabilities                 
Warrants payable    $ 1,850,514     $ 1,745,496     $ 3,596,010     
Accounts payable and accrued expenses   682,383     311,354     993,737     
Retainage payable   -   164,392     164,392     
Due to federal and state governments    -   19,101  19,101  
Notes payable   -   6,499,066   6,499,066   
Total liabilities   2,532,897   8,739,409   11,272,306  
Deferred inflows of resources               
Property taxes paid in advance  62,260  -   62,260  
Deferred property tax revenues  3,809,278   -   3,809,278   
Deferred user fees and fines    6,141,568   --  6,141,568   
Deferred revenue from ARA   616,048         616,048     
Unearned income     -   8,240   8,240   
Deferred grant income   -   253,192     253,192     
Deferred loan income    -   2,124,915   2,124,915   
Total deferred inflows of resources     10,629,154  2,386,347   13,015,501  
Fund balance                
Nonspendable    -   315,478     315,478     
Restricted  -   7,235,505   7,235,505   
Committed   3,172,925   9,500,776   12,673,701  
Assigned    2,100,746   --  2,100,746   
Unassigned  5,575,272   (1,794,031)     3,781,241   
Total fund balance  10,848,943  15,257,728  26,106,671  
Total liabilities, deferred inflows of resources and fund balance   $ 24,010,994    $ 26,383,484    $ 50,394,478    </code></pre>
</div>
<div id="comparing-the-textract-results" class="section level1">
<h1>Comparing the Textract Results</h1>
<p>As a refresher from <a href="https://redwallanalytics.com/2020/04/14/evaluating-mass-muni-cafr-tabulizer-results-part-3/">Evaluating Mass Muni CAFR Tabulizer Results - Part 3</a>, we started with 149 Massachusetts municipalities, and 5 PDFs couldn’t be read at all with OCR (because of their formatting). Of the remaining CAFRs, we were able to match all elements of 121 perfectly, and 23 had one or more elements which failed to match. Textract didn’t really help with the PDFs which couldn’t be read by OCR, although we really didn’t try those because our method relied on <code>pdftools</code> using OCR to get the page index.</p>
<div class="figure"><span id="fig:textract-compare"></span>
<div id="htmlwidget-2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73"],["attleboro","boston","chatham","clinton","fall_river","mashpee","millbury","montague","new_bedford","sandwich","swansea","weston","attleboro","boston","clinton","eastham","fall_river","mashpee","millbury","montague","new_bedford","sandwich","swansea","weston","winchendon","winchester","attleboro","boston","clinton","concord","dukes_county","eastham","hudson","malden","methuen","montague","new_bedford","newton","sandwich","walpole","westford","weston","winchester","boston","clinton","concord","dartmouth","east_bridgewater","fall_river","hingham","hudson","montague","new_bedford","rockland","sandwich","waltham","weston","boston","clinton","concord","dartmouth","east_bridgewater","fall_river","franklin","hingham","hudson","montague","new_bedford","rockland","sandwich","waltham","weston","winchester"],["diff_assigned","diff_assigned","diff_assigned","diff_assigned","diff_assigned","diff_assigned","diff_assigned","diff_assigned","diff_assigned","diff_assigned","diff_assigned","diff_assigned","diff_unassigned","diff_unassigned","diff_unassigned","diff_unassigned","diff_unassigned","diff_unassigned","diff_unassigned","diff_unassigned","diff_unassigned","diff_unassigned","diff_unassigned","diff_unassigned","diff_unassigned","diff_unassigned","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_total_exp","diff_unrestricted","diff_unrestricted","diff_unrestricted","diff_unrestricted","diff_unrestricted","diff_unrestricted","diff_unrestricted","diff_unrestricted","diff_unrestricted","diff_unrestricted","diff_unrestricted","diff_unrestricted","diff_unrestricted","diff_unrestricted","diff_net_position","diff_net_position","diff_net_position","diff_net_position","diff_net_position","diff_net_position","diff_net_position","diff_net_position","diff_net_position","diff_net_position","diff_net_position","diff_net_position","diff_net_position","diff_net_position","diff_net_position","diff_net_position"],["Same wrong value","Same wrong value","Same wrong value","OCR problem","Textract fixed","Textract fixed","Textract fixed","Textract fixed","OCR problem","Textract fixed","Textract fixed","OCR problem","Different wrong value","Same wrong value","OCR problem","Same wrong value","Textract fixed","Different wrong value","Textract fixed","Textract fixed","OCR problem","Textract fixed","Different wrong value","OCR problem","Same wrong value","Textract fixed","Same wrong value","Different wrong value","OCR problem","Same wrong value","Same wrong value","Textract fixed","Same wrong value","Different wrong value","Textract fixed","Different wrong value","OCR problem","Same wrong value","Same wrong value","Textract fixed","Same wrong value","OCR problem","Textract fixed","Same wrong value","OCR problem","Same wrong value","Textract fixed","Same wrong value","Textract fixed","Textract fixed","Same wrong value","Textract fixed","OCR problem","Textract fixed","Textract fixed","Textract fixed","OCR problem","Same wrong value","OCR problem","Same wrong value","Textract fixed","Same wrong value","Same wrong value","Same wrong value","Textract fixed","Same wrong value","Textract fixed","OCR problem","Textract fixed","Same wrong value","Textract fixed","OCR problem","Textract fixed"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Municipality<\/th>\n      <th>Element<\/th>\n      <th>Final<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 1: Textract fixed almost half of wrongly extracted tabulizer elements
</p>
</div>
<p>For our Textract trial, we started with the 23 municipalities where there were known problems matching manually extracted data for 43 elements. Of the requested 125 tables from Textract for about $2, all but a 4 tables were returned without problems. Of the challenging elements, we successfully extracted 21 from 12 municipalities with Textract for about $2. Recall that we were able to accurately extract all but about 6% of the cases we wanted with <code>pdftools</code> and <code>tabulizer</code>, so combined with Textract, we got about 97% right. We didn’t spend much time fine tuning our regex and cleaning of the raw Textract output, so if this were going to be a repeated process, it could likely be further improved.</p>
</div>
<div id="series-summary" class="section level1">
<h1>Series summary</h1>
<p>As reminder of the tools demonstrated in this 5-part series,</p>
<ol style="list-style-type: decimal">
<li><p>Find the location of a table on a page with regex matching and <code>pdftools</code>
<a href="https://redwallanalytics.com/2020/04/06/tabulizer-and-pdftools-togeteher-as-super-powers-part-2/">Tabulizer and pdftools Together as Super-powers</a></p></li>
<li><p>Extract a particular page from a pdf with <code>pdftools</code>
<a href="https://redwallanalytics.com/2020/04/06/tabulizer-and-pdftools-togeteher-as-super-powers-part-2/">Tabulizer and pdftools Together as Super-powers</a></p></li>
<li><p>Aggregate multiple PDF pages together
<a href="https://redwallanalytics.com/2020/04/06/tabulizer-and-pdftools-togeteher-as-super-powers-part-2/">Tabulizer and pdftools Together as Super-powers</a></p></li>
<li><p>Use pdttools to find exact table parameters and accurately extract a large amount of slightly varying tables combining <code>pdftools</code> and <code>tabulizer</code>
<a href="https://redwallanalytics.com/2020/04/06/tabulizer-and-pdftools-togeteher-as-super-powers-part-2/">Tabulizer and pdftools Together as Super-powers</a></p></li>
<li><p>Connect and interact with AWS’<code>s3</code> with the <code>paws</code> SDK
<a href="https://redwallanalytics.com/2020/04/14/scraping-failed-tabulizer-pdfs-with-aws-textract-part-4/">Scraping Failed Tabulizer PDFs with AWS Textract</a></p></li>
<li><p>Send requests to AWS <code>Textract</code> from <code>s3</code> and use bulk asynchronous operation with the <code>paws</code> SDK
<a href="https://redwallanalytics.com/2020/04/14/scraping-failed-tabulizer-pdfs-with-aws-textract-part-4/">Scraping Failed Tabulizer PDFs with AWS Textract</a></p></li>
<li><p>Convert a PDF page to PNG and send and receive single page requests to AWS Textract.
[This post]</p></li>
<li><p>Study the anatomy of the AWS JSON response object and use the Python parser from R with <code>reticulate</code> to convert it back into a tabular form.
[This post]</p></li>
</ol>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>It has been over 10 years since the the SEC mandated company financial statements be reported in XBRL. Marc Joffe has advocated for the similar requirements for municipal reporting, a subject which becomes all the more critical at a time when many governments are likely to need emergency funding. After our exploration of amost 150 PDFs, we believe that it would be possible for auditors to come close to the efficacy of XBRL with a few mandatory guidelines for PDF formatting.</p>
<p>Although there were 73 problem elements, there were only a few patterns common in the large majority of cases:</p>
<ul>
<li>Scanned images of printed documents</li>
<li>Tables which ran over onto a second page without repeating the column headers</li>
<li>Tables which included a second section on the same page with large indentations</li>
<li>Lack of uniformity of header and footer formatting and naming</li>
<li>Lack of uniformity in line-item names (ie: Total Net Position and Net Position)</li>
</ul>
<p>We now have a dataset which could be used to greatly improve the machine readability of municipal financial statements with a small number of prescribed formatting guidelines.</p>
</div>
